<!DOCTYPE html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title></title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="css/normalize.min.css">
	<link rel="stylesheet" href="css/main.css">

	<script src="build/app.libs.js" type="text/javascript"></script>
	<script src="build/app.js" type="text/javascript"></script>

</head>
<body>
<!--[if lt IE 7]>
<p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
	your browser</a> to improve your experience.</p>
<![endif]-->
<div id="example"></div>
<div id="user"></div>

<script>
	var user = {};

	/**
	 *
	 * @param {object} data
	 * @constructor
	 */
	user.UserInfo = function () {

	};

	user.UserInfo.prototype.init = function (data) {
		this.data = data;
		this.userId = this.data.feed.gphoto$user.$t;
		this.entry = this.data.feed.entry;
	};

	user.getData = function () {
		return m.request({method: "GET", url: "https://picasaweb.google.com/data/feed/api/user/108104263107535951418/?alt=json"});
	};

	user.controller = function (id) {
		var self = this;
		this.model = new user.UserInfo({});

		user.getData().then(function (data) {
			self.model.init(data);
			self.album = new entry.controller(self.model.entry[0]);
			console.log(self.model.userId, data);
		});
	};
	user.view = function (ctrl) {
		return [
			m("a", ctrl.model.userId),
			ctrl.model.entry.map(function (data) {
				return m("div", [
					m("div", entry.view(new entry.controller(data))),
					m("div", "---")
				]);
			}),
		];
	};

	var entry = {};

	entry.Album = function (data) {
		this.title = data.title.$t;
		this.link = data.link[1].href;
	};
	entry.controller = function (data) {
		this.model = new entry.Album(data)
	};
	entry.view = function (controller) {
		return m("div", [
			m("div", controller.model.title),
			m("div", controller.model.link)
		]);
	};

	m.module(document.getElementById("user"), user);


	//			//m.module(document.getElementById("example"), xxx);
	//
	//			//this application only has one module: todo
	//			var todo = {};
	//
	//			//for simplicity, we use this module to namespace the model classes
	//
	//			//the Todo class has two properties
	//			todo.Todo = function(data) {
	//				this.description = m.prop(data.description);
	//				this.done = m.prop(false);
	//			};
	//
	//			//the TodoList class is a list of Todo's
	//			todo.TodoList = Array;
	//
	//			//the controller uses three model-level entities, of which one is a custom defined class:
	//			//`Todo` is the central class in this application
	//			//`list` is merely a generic array, with standard array methods
	//			//`description` is a temporary storage box that holds a string
	//			//
	//			//the `add` method simply adds a new todo to the list
	//			todo.controller = function() {
	//				this.list = new todo.TodoList();
	//				this.description = m.prop("");
	//
	//				this.chuj = new xxx.controller("test");
	//				console.log(this.chuj);
	//
	//				this.add = function() {
	//					if (this.description()) {
	//						this.list.push(new todo.Todo({description: this.description()}));
	//						this.description("");
	//					}
	//				}.bind(this);
	//			};
	//
	//			//here's the view
	//			todo.view = function(ctrl) {
	//				return m("html", [
	//					m("body", [
	//						m("div", xxx.view(ctrl.chuj)),
	//						m("input", {onchange: m.withAttr("value", ctrl.description), value: ctrl.description()}),
	//						m("button", {onclick: ctrl.add}, "Add"),
	//						m("table", [
	//							ctrl.list.map(function(task, index) {
	//								return m("tr", [
	//									m("td", [
	//										m("input[type=checkbox]", {onclick: m.withAttr("checked", task.done), checked: task.done()})
	//									]),
	//									m("td", {style: {textDecoration: task.done() ? "line-through" : "none"}}, task.description()),
	//								])
	//							})
	//						])
	//					])
	//				]);
	//			};

	//initialize the application
	//			m.module(document, todo);
</script>

<div>
	tessdsdt
</div>


<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
	(function (b, o, i, l, e, r) {
		b.GoogleAnalyticsObject = l;
		b[l] || (b[l] =
				function () {
					(b[l].q = b[l].q || []).push(arguments)
				});
		b[l].l = +new Date;
		e = o.createElement(i);
		r = o.getElementsByTagName(i)[0];
		e.src = '//www.google-analytics.com/analytics.js';
		r.parentNode.insertBefore(e, r)
	}(window, document, 'script', 'ga'));
	ga('create', 'UA-XXXXX-X');
	ga('send', 'pageview');
</script>
</body>
</html>
